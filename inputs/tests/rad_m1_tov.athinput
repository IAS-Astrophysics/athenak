# Athena++ (Kokkos version) input file for TOV star

<comment>
problem  = radiation m1 tov 

<job>
basename = tov

<mesh>
nghost = 4       # Number of ghost cells
nx1    = 64      # number of cells in x1-direction
x1min  = 0.0     # minimum x1
x1max  = 204.8   # maximum x1
ix1_bc = reflect # inner boundary
ox1_bc = outflow # outer boundary

nx2    = 64      # number of cells in x2-direction
x2min  = 0.0     # minimum x2
x2max  = 204.8   # maximum x2
ix2_bc = reflect # inner boundary
ox2_bc = outflow # outer boundary

nx3    = 64      # number of cells in x3-direction
x3min  = 0.0     # minimum x3
x3max  = 204.8   # maximum x3
ix3_bc = reflect # inner boundary
ox3_bc = outflow # outer boundary

<meshblock>
nx1  = 32        # Number of cells in each MeshBlock, X1-dir
nx2  = 32        # Number of cells in each MeshBlock, X2-dir
nx3  = 32        # Number of cells in each MeshBlock, X3-dir

<mesh_refinement>
refinement = static
num_levels = 4

<refinement1>
x1min = 0.0
x1max = 12.7
x2min = 0.0
x2max = 12.7
x3min = 0.0
x3max = 12.7
level = 4

<time>
evolution  = dynamic    # dynamic/kinematic/static
integrator = rk3        # time integration algorithm
cfl_number = 0.2
nlim       = -1
tlim       = 10000
ndiag      = 1          # cycles between diagnostic output

<coord>
general_rel = true      # general relativity
m           = 1.0
a           = 0.0
excise      = false

<radiation_m1>
num_species = 4
closure_fun = minerbo
src_update = implicit
opacity_type = bns-nurates
backreact = false

<mhd>
eos         = ideal     # EOS type
dyn_eos     = compose     # EOS type
dyn_error   = reset_floor # error policy
reconstruct = wenoz     # spatial reconstruction method
rsolver     = hlle      # Riemann solver to be used
dfloor      = 1.28e-13   # floor on density rho
tfloor      = 1.28e-11 
dthreshold  = 0.1       # Threshold for flooring
gamma       = 2.0       # ratio of specific heats Gamma
dyn_scratch = 0
fofc        = true
enforce_maximum = false
dmp_M       = 1.2
nscalars = 1
s0_atmosphere = 0.5
table       = /global/homes/y/yiqiu/DD2/DD2.athtab

<adm>

<z4c>
diss        = 0.1
extrap_order = 2

<problem>
table       = /global/homes/y/yiqiu/DD2/DD2_cold.athtab
rhoc        = 1.28e-3 # Central density
kappa       = 100.0    # P = kappa*rho^gamma
npoints     = 10000.0  # buffer points for TOV calculation
dr          = 1e-3     # radial step for TOV calculation
b_norm      = 0.0
pcut        = 1e-6
magindex    = 1
isotropic   = true
user_hist   = true
v_pert      = 0.0
rho_cut = 1.0e-7

<output1>
file_type   = rst
dt          = 1000.0

<output2>
file_type   = hst      # History data dump
dt          = 0.00001  # time increment between outputs
data_format = %20.15e

<output3>
file_type   = bin      # Binary output
variable    = mhd_w
dt          = 10.
slice_x3    = 0.0

<output4>
file_type   = bin      # Binary output
variable    = rad_m1_E
dt          = 10.
slice_x3    = 0.0
