#include "myassert.hpp"
#include <stdlib.h>
namespace decomp_Chebyshev
{

  double ChebyshevU (int n, double x);
  double ChebyshevU (int n, double x)
  {
    double UU[101];
    double X[101];

      myassert (n > -1);
      myassert (n < 31);

      X[0] = 1;
    for (int i = 1; i < 101; i++)
    {
      X[i] = X[i - 1] * x;
    }

    UU[0] = 1.0;
    UU[1] = 2.0 * x;
    UU[2] = -1 + 4 * X[2];
    UU[3] = -4 * x + 8 * X[3];
    UU[4] = 1 - 12 * X[2] + 16 * X[4];
    UU[5] = 6 * x - 32 * X[3] + 32 * X[5];
    UU[6] = -1 + 24 * X[2] - 80 * X[4] + 64 * X[6];
    UU[7] = -8 * x + 80 * X[3] - 192 * X[5] + 128 * X[7];
    UU[8] = 1 - 40 * X[2] + 240 * X[4] - 448 * X[6] + 256 * X[8];
    UU[9] = 10 * x - 160 * X[3] + 672 * X[5] - 1024 * X[7] + 512 * X[9];
    UU[10] = -1 + 60 * X[2] - 560 * X[4] + 1792 * X[6] - 2304 * X[8] +
      1024 * X[10];
    UU[11] =
      -12 * x + 280 * X[3] - 1792 * X[5] + 4608 * X[7] - 5120 * X[9] +
      2048 * X[11];
    UU[12] =
      1 - 84 * X[2] + 1120 * X[4] - 5376 * X[6] + 11520 * X[8] -
      11264 * X[10] + 4096 * X[12];
    UU[13] =
      14 * x - 448 * X[3] + 4032 * X[5] - 15360 * X[7] + 28160 * X[9] -
      24576 * X[11] + 8192 * X[13];
    UU[14] =
      -1 + 112 * X[2] - 2016 * X[4] + 13440 * X[6] - 42240 * X[8] +
      67584 * X[10] - 53248 * X[12] + 16384 * X[14];
    UU[15] =
      -16 * x + 672 * X[3] - 8064 * X[5] + 42240 * X[7] -
      112640 * X[9] + 159744 * X[11] - 114688 * X[13] + 32768 * X[15];
    UU[16] =
      1 - 144 * X[2] + 3360 * X[4] - 29568 * X[6] + 126720 * X[8] -
      292864 * X[10] + 372736 * X[12] - 245760 * X[14] + 65536 * X[16];
    UU[17] =
      18 * x - 960 * X[3] + 14784 * X[5] - 101376 * X[7] +
      366080 * X[9] - 745472 * X[11] + 860160 * X[13] - 524288 * X[15] +
      131072 * X[17];
    UU[18] =
      -1 + 180 * X[2] - 5280 * X[4] + 59136 * X[6] - 329472 * X[8] +
      1025024 * X[10] - 1863680 * X[12] + 1966080 * X[14] -
      1114112 * X[16] + 262144 * X[18];
    UU[19] =
      -20 * x + 1320 * X[3] - 25344 * X[5] + 219648 * X[7] -
      1025024 * X[9] + 2795520 * X[11] - 4587520 * X[13] +
      4456448 * X[15] - 2359296 * X[17] + 524288 * X[19];
    UU[20] =
      1 - 220 * X[2] + 7920 * X[4] - 109824 * X[6] + 768768 * X[8] -
      3075072 * X[10] + 7454720 * X[12] - 11141120 * X[14] +
      10027008 * X[16] - 4980736 * X[18] + 1048576 * X[20];

    UU[21] =
      22 * x - 1760 * X[3] + 41184 * X[5] - 439296 * X[7] +
      2562560 * X[9] - 8945664 * X[11] + 19496960 * X[13] -
      26738688 * X[15] + 22413312 * X[17] - 10485760 * X[19] +
      2097152 * X[21];

    UU[22] =
      -1 + 264 * X[2] - 11440 * X[4] + 192192 * X[6] - 1647360 * X[8] +
      8200192 * X[10] - 25346048 * X[12] + 50135040 * X[14] -
      63504384 * X[16] + 49807360 * X[18] - 22020096 * X[20] +
      4194304 * X[22];

    UU[23] =
      -24 * x + 2288 * X[3] - 64064 * X[5] + 823680 * X[7] -
      5857280 * X[9] + 25346048 * X[11] - 70189056 * X[13] +
      127008768 * X[15] - 149422080 * X[17] + 110100480 * X[19] -
      46137344 * X[21] + 8388608 * X[23];

    UU[24] =
      1 - 312 * X[2] + 16016 * X[4] - 320320 * X[6] + 3294720 * X[8] -
      19914752 * X[10] + 76038144 * X[12] - 190513152 * X[14] +
      317521920 * X[16] - 348651520 * X[18] + 242221056 * X[20] -
      96468992 * X[22] + 16777216 * X[24];

    UU[25] = 26 * x - 2912 * X[3] + 96096 * X[5] - 1464320 * X[7] +
      12446720 * X[9] - 65175552 * X[11] + 222265344 * X[13] -
      508035072 * X[15] + 784465920 * X[17] - 807403520 * X[19] +
      530579456 * X[21] - 201326592 * X[23] + 33554432 * X[25];

    UU[26] =
      -1 + 364 * X[2] - 21840 * X[4] + 512512 * X[6] - 6223360 * X[8] +
      44808192 * X[10] - 206389248 * X[12] + 635043840 * X[14] -
      1333592064 * X[16] + 1917583360 * X[18] - 1857028096 * X[20] +
      1157627904 * X[22] - 419430400 * X[24] + 67108864 * X[26];

    UU[27] = -28 * x + 3640 * X[3] - 139776 * X[5] + 2489344 * X[7] -
      24893440 * X[9] + 154791936 * X[11] - 635043840 * X[13] +
      1778122752 * X[15] - 3451650048 * X[17] + 4642570240 * X[19] -
      4244635648 * X[21] + 2516582400 * X[23] - 872415232 * X[25] +
      134217728 * X[27];

    UU[28] =
      1 - 420 * X[2] + 29120 * X[4] - 792064 * X[6] + 11202048 * X[8] -
      94595072 * X[10] + 515973120 * X[12] - 1905131520 * X[14] +
      4889837568 * X[16] - 8820883456 * X[18] + 11142168576 * X[20] -
      9646899200 * X[22] + 5452595200 * X[24] - 1811939328 * X[26] +
      268435456 * X[28];

    UU[29] = 30 * x - 4480 * X[3] + 198016 * X[5] - 4073472 * X[7] +
      47297536 * X[9] - 343982080 * X[11] + 1666990080 * X[13] -
      5588385792 * X[15] + 13231325184 * X[17] - 22284337152 * X[19] +
      26528972800 * X[21] - 21810380800 * X[23] + 11777605632 * X[25] -
      3758096384 * X[27] + 536870912 * X[29];

    UU[30] =
      -1 + 480 * X[2] - 38080 * X[4] + 1188096 * X[6] -
      19348992 * X[8] + 189190144 * X[10] - 1203937280 * X[12] +
      5239111680 * X[14] - 16066609152 * X[16] + 35283533824 * X[18] -
      55710842880 * X[20] + 62704844800 * X[22] - 49073356800 * X[24] +
      25367150592 * X[26] - 7784628224 * X[28] + 1073741824 * X[30];


    return UU[n];
  }


}
